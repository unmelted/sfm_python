from scipy import interpolate
from scipy.interpolate import Rbf, InterpolatedUnivariateSpline
import matplotlib.pyplot as plt
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

y = [433.1806279582977, 439.1644534464699, 446.52362093921755, 454.1734401948577, 462.3679260795503, 470.6753370352031, 476.6514253224925, 479.45977261482307, 480.7934308382034, 481.6900470521487, 481.47199643238133, 479.88655839745576, 478.6035360159678, 476.7864028013591, 475.1386481260418, 473.2003294371019, 470.61240803886216, 467.4665747000786, 464.07585400578597, 459.973317043019, 456.87570310343995, 451.30159986721037, 446.4302747539917, 441.3031690752737, 436.8073796206278, 432.533915935425, 427.7236522211123, 422.15717910835724, 415.6993013362312, 409.6149168394706, 405.5981893201263, 404.1685048314403, 403.82752941007175, 403.4354026632514, 402.7853608372122, 401.8219633449384, 400.4815089904809, 398.90080405401864, 397.2089126203471, 395.533915232103,
     394.0244576243747, 392.7989298595639, 391.7419658561115, 390.7284596545831, 389.6113893856506, 388.4112716539907, 387.8687363156956, 387.19678729503863, 382.45516304249406, 375.96173659434214, 369.59804516407485, 363.13996767548736, 357.46985442534753, 352.1376885467667, 347.11022898895186, 342.5164358475562, 338.2685103069393, 334.31840313743913, 330.5233973970903, 327.56642906803546, 323.9137544442577, 321.78174032879036, 319.174124203804, 317.33503525923294, 315.8695131578476, 314.48792864980834, 314.0144776775881, 313.89626594236734, 314.30442710338014, 315.0566201403934, 315.94013370872756, 316.7832494083878, 318.3392252836223, 320.217292681936, 322.3381487789554, 325.28138156081184, 326.13521059860904, 330.1586531717389, 336.30772614558424, 339.6409168332481]

z = [675.6977043476277, 670.5826517660935, 665.3161109437772, 663.914498511892, 666.2274427617272, 668.547432384672, 671.1461835930257, 673.9066990620311, 676.752842255325, 679.8264350592021, 683.0286164798028, 686.166277319379, 689.09945377791, 691.6404119559099, 694.173376351747, 696.7252331034438, 699.2724917214717, 701.8085010872047, 704.4278669971347, 706.8202898649625, 709.420632142378, 711.8161585406762, 714.036399312431, 715.7736957302809, 717.5273125726053, 719.3409427200334, 720.9671590001897, 722.7377937988963, 724.4514201341892, 725.6897995683867, 726.2869230818127, 726.9597815670177, 727.8317842176632, 728.3323550452347, 728.8305367285692, 729.4610835182044, 730.028704967453, 730.6387907780454, 731.3517676380013, 731.8614977525111,
     732.3202753505383, 732.7197317709708, 733.0208523368591, 733.1740106500093, 733.1439748091187, 733.1530061435706, 733.214529441194, 732.9775287895067, 733.0631275452322, 732.2897329652802, 730.9449843835228, 730.0705404905837, 728.3849401904383, 726.4701595705207, 724.4720507437526, 722.3063730597266, 720.038814977996, 717.6818282447824, 715.2797710388228, 712.3233466914498, 709.2466497010774, 706.0971440684292, 702.8455967629213, 699.4766961369105, 696.1929343094956, 692.9811839261762, 689.7055760627758, 686.6767733497308, 683.9296675509087, 681.3805149916283, 678.8931604648943, 676.3195210545354, 673.4665197634685, 670.2338627920077, 667.3959318112062, 667.7533574393086, 671.1804592210242, 674.4124646409881, 677.9426118887914, 681.8309406829948]

# y = [0, 1, 3, 4, 3, 5, 7, 5, 2, 3, 4, 8, 9, 8, 7]
n = len(y)
x = range(0, n)

# plt.plot(x, y, 'ro', label="original")
# plt.plot(x, y, 'b', label="linear interpolation")
# plt.title("Target data")
# plt.legend(loc='best', fancybox=True, shadow=True)
# plt.grid()
# plt.show()

tck = interpolate.splrep(x, y, s=2400, k=2)
tck2 = interpolate.splrep(x, z, s=2400, k=2)

#tck = InterpolatedUnivariateSpline(x, y)
x_new = np.linspace(min(x), max(x), 80)
y_fit = interpolate.BSpline(*tck)(x_new)
z_fit = interpolate.BSpline(*tck2)(x_new)

print(y_fit[0], y_fit[30])
print(z_fit[0], z_fit[3])

plt.title("BSpline curve fitting")
plt.plot(x, y, 'ro', label="original")
plt.plot(x_new, y_fit, '-c', label="B-spline")
plt.legend(loc='best', fancybox=True, shadow=True)
plt.grid()
plt.show()

plt.title("BSpline curve fitting2")
plt.plot(x, z, 'ro', label="original")
plt.plot(x_new, z_fit, '-c', label="B-spline")
plt.legend(loc='best', fancybox=True, shadow=True)
plt.grid()
plt.show()


# x = np.arange(-5.01, 5.01, 0.25)
# y = np.arange(-5.01, 5.01, 0.25)
# xx, yy = np.meshgrid(x, y)
# z = np.sin(xx**2+yy**2)
# f = interpolate.interp2d(x, y, z, kind='cubic')

# xnew = np.arange(-5.01, 5.01, 1e-2)
# ynew = np.arange(-5.01, 5.01, 1e-2)
# znew = f(xnew, ynew)
# plt.plot(x, z[0, :], 'ro-', xnew, znew[0, :], 'b-')
# plt.show()
